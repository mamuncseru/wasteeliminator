{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/HP/Documents/React Native/wasteeliminator/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/HP/Documents/React Native/wasteeliminator/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/HP/Documents/React Native/wasteeliminator/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{Fragment,useState,useEffect}from\"react\";import Map from\"../Map/Map\";import Post from\"../Post/Post\";import AddPost from\"../Post/AddPost\";import PostCard from\"../UI/Card/PostCard\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var flag=true;var Alert=function Alert(_ref){var token=_ref.token;var _useState=useState(),_useState2=_slicedToArray(_useState,2),posts=_useState2[0],setPosts=_useState2[1];var _useState3=useState(flag),_useState4=_slicedToArray(_useState3,2),updatedData=_useState4[0],setUpdatedData=_useState4[1];var _useState5=useState({lat:0,long:0}),_useState6=_slicedToArray(_useState5,2),location=_useState6[0],setLocation=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),geoError=_useState8[0],setGeoError=_useState8[1];useEffect(function(){window.navigator.geolocation.getCurrentPosition(function(position){return setLocation({lat:position.coords.latitude,long:position.coords.longitude});},function(err){return setGeoError(err.message);});},[]);useEffect(function(){var url=\"https://waste-eliminator-api.us-south.cf.appdomain.cloud/datas\";fetch(url).then(function(res){return res.json();}).then(function(data){setPosts(data.datas);});},[updatedData]);var submitPostHandler=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(payload){var response,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return fetch(\"https://waste-eliminator-api.us-south.cf.appdomain.cloud/datas\",{method:\"POST\",body:payload,headers:{Authorization:token}});case 3:response=_context.sent;_context.next=6;return response.json();case 6:data=_context.sent;console.log(data);setUpdatedData(!flag);_context.next=14;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 14:case\"end\":return _context.stop();}}},_callee,null,[[0,11]]);}));return function submitPostHandler(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(Fragment,{children:[/*#__PURE__*/_jsx(Map,{updatedData:updatedData,styling:\"post\",height:\"100%\",width:\"68%\"}),/*#__PURE__*/_jsxs(PostCard,{children:[token&&/*#__PURE__*/_jsx(AddPost,{onConfirm:submitPostHandler,location:location,geoError:geoError}),!token&&/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"h2\",{style:{marginTop:'6rem'},children:\"You must login to make an alert.\"})})]}),posts&&posts.slice(posts.length-5,posts.length).reverse().map(function(post){return/*#__PURE__*/_jsx(PostCard,{children:/*#__PURE__*/_jsx(\"ul\",{children:/*#__PURE__*/_jsx(Post,{id:post._id,lat:post.location.lat,long:post.location.long,wasteType:post.wasteType,image:post.image},post._id)},post._id)});})]});};export default Alert;","map":{"version":3,"sources":["C:/Users/HP/Documents/React Native/wasteeliminator/src/components/Alert/Alert.js"],"names":["Fragment","useState","useEffect","Map","Post","AddPost","PostCard","flag","Alert","token","posts","setPosts","updatedData","setUpdatedData","lat","long","location","setLocation","geoError","setGeoError","window","navigator","geolocation","getCurrentPosition","position","coords","latitude","longitude","err","message","url","fetch","then","res","json","data","datas","submitPostHandler","payload","method","body","headers","Authorization","response","console","log","marginTop","slice","length","reverse","map","post","_id","wasteType","image"],"mappings":"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","sourcesContent":["import { Fragment, useState, useEffect } from \"react\";\nimport Map from \"../Map/Map\";\nimport Post from \"../Post/Post\";\nimport AddPost from \"../Post/AddPost\";\nimport PostCard from \"../UI/Card/PostCard\";\n\nconst flag = true;\n\nconst Alert = ({ token }) => {\n  const [posts, setPosts] = useState();\n  const [updatedData, setUpdatedData] = useState(flag);\n  const [location, setLocation] = useState({ lat: 0, long: 0 });\n  const [geoError, setGeoError] = useState(\"\");\n\n  useEffect(() => {\n    window.navigator.geolocation.getCurrentPosition(\n      (position) =>\n        setLocation({\n          lat: position.coords.latitude,\n          long: position.coords.longitude,\n        }),\n      (err) => setGeoError(err.message)\n    );\n  }, []);\n\n  useEffect(() => {\n    const url = \"https://waste-eliminator-api.us-south.cf.appdomain.cloud/datas\"\n\n    fetch(url)\n      .then(res => res.json())\n      .then(data => {\n        setPosts(data.datas);\n      });\n  }, [updatedData]);\n\n  const submitPostHandler = async (payload) => {\n    try {\n      const response = await fetch(\n        \"https://waste-eliminator-api.us-south.cf.appdomain.cloud/datas\",\n        {\n          method: \"POST\",\n          body: payload,\n          headers: {\n            Authorization: token,\n          },\n        }\n      );\n\n      const data = await response.json();\n      console.log(data);\n      setUpdatedData(!flag);\n    } catch (err) {\n      console.log(err);\n    }\n  };\n\n \n  return (\n    <Fragment>\n      <Map updatedData={updatedData} styling=\"post\" height=\"100%\" width=\"68%\" />\n      <PostCard>\n        {token && (\n          <AddPost\n          onConfirm={submitPostHandler}\n          location={location}\n          geoError={geoError}\n        />\n        )}\n        {!token && (\n          <div>\n            <h2 style={{ marginTop: '6rem'}}>You must login to make an alert.</h2>\n          </div>\n        )\n\n        }\n      </PostCard>\n\n      {posts && posts.slice(posts.length-5, posts.length).reverse().map((post) => (\n        <PostCard>\n          <ul key={post._id}>\n            <Post\n              id={post._id}\n              key={post._id}\n              lat={post.location.lat}\n              long={post.location.long}\n              wasteType={post.wasteType}\n              image={post.image}\n            />\n          </ul>\n        </PostCard>\n      ))}\n    </Fragment>\n  );\n};\n\nexport default Alert;\n"]},"metadata":{},"sourceType":"module"}